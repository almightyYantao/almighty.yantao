<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>检测 on Almighty.YanTao</title>
    <link>/tags/%E6%A3%80%E6%B5%8B/</link>
    <description>Recent content in 检测 on Almighty.YanTao</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Mon, 20 Feb 2023 00:00:00 +0800</lastBuildDate><atom:link href="/tags/%E6%A3%80%E6%B5%8B/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>curl 检测代理的可用性以及延迟</title>
      <link>/2023/02/20/curl-%E6%A3%80%E6%B5%8B%E4%BB%A3%E7%90%86%E7%9A%84%E5%8F%AF%E7%94%A8%E6%80%A7%E4%BB%A5%E5%8F%8A%E5%BB%B6%E8%BF%9F.html/</link>
      <pubDate>Mon, 20 Feb 2023 00:00:00 +0800</pubDate>
      
      <guid>/2023/02/20/curl-%E6%A3%80%E6%B5%8B%E4%BB%A3%E7%90%86%E7%9A%84%E5%8F%AF%E7%94%A8%E6%80%A7%E4%BB%A5%E5%8F%8A%E5%BB%B6%E8%BF%9F.html/</guid>
      <description>背景 在办公网的代理翻墙的过程中，经常没办法第一时间知道代理失效了，因为我们自身不是高用的用户，每次挂了都需要员工来反馈，体感非常的不好，因此想着可以通过zabbix如果把当前的延迟、可用性检测起来
通过Curl 检测Google的延迟 这里为啥是curl而不是ping，因为默认ping事不支持代理的，然而curl也可以做到真正的是否可用
1 curl -o /dev/null -x socks5h://127.0.0.1:12126 -s --connect-timeout 5 -w %{time_starttransfer}&amp;#34;\n&amp;#34; $1 socks5h的地址需要改成你的代理地址
1 2 3 4 5 6 7 8 9 10 # 获取当前代理的可用性 ```bash url=$1 result=($(curl -x socks5h://localhost:12126 -I -s --connect-timeout 5 ${url} | head -1 | tr &amp;#34;\r&amp;#34; &amp;#34;\n&amp;#34;)) if [ &amp;#34;${result[1]}&amp;#34; == $2 -a &amp;#34;${result[2]}&amp;#34; == &amp;#39;OK&amp;#39; ] then echo 1 else echo 0 fi zabbix操作脚本 1 2 3 4 5 # 延迟 UserParameter=googleTime[*],/etc/zabbix/script/googleTime.</description>
    </item>
    
  </channel>
</rss>
